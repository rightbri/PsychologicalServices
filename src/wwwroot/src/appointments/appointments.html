<template>
<h2>Appointment Search</h2>

<form class="search-parameters">
	<div class="form-group">
		<label for="searchStartDate">Date Start</label>
		<input id="searchStartDate" class="form-control" type="text" placeholder="MM/DD/YYYY" value.bind="searchStart" />
	</div>
	<div class="form-group">
		<label for="searchEndDate">Date End</label>
		<input id="searchEndDate" class="form-control" type="text" placeholder="MM/DD/YYYY" value.bind="searchEnd" />
	</div>
	<div class="form-group">
		<label for="searchPsychometrist">Psychometrist</label>
		<select id="searchPsychometrist" class="form-control" value.bind="searchPsychometrist">
			<option model.bind="null"></option>
			<option repeat.for="psychometrist of psychometrists" model.bind="psychometrist.userId">
				${psychometrist.firstName} ${psychometrist.lastName}
			</option>
		</select>
	</div>
	<div class="form-group">
		<label for="searchPsychologist">Psychologist</label>
		<select id="searchPsychologist" class="form-control" value.bind="searchPsychologist">
			<option model.bind="null"></option>
			<option repeat.for="psychologist of psychologists" model.bind="psychologist.userId">
				${psychologist.firstName} ${psychologist.lastName}
			</option>
		</select>
	</div>
	<div class="form-group">
		<label for="searchStatus">Status</label>
		<select id="searchStatus" class="form-control" value.bind="searchStatus">
			<option model.bind="null"></option>
			<option repeat.for="appointmentStatus of appointmentStatuses" model.bind="appointmentStatus.appointmentStatusId">
				${appointmentStatus.name}
			</option>
		</select>
	</div>
	<div class="form-group">
		<label for="searchCompany">Company</label>
		<select id="searchCompany" class="form-control" value.bind="searchCompany">
			<option if.bind="hasMultipleCompanies(companies)" model.bind="null"></option>
			<option repeat.for="company of companies" model.bind="company.companyId">
				${company.name}
			</option>
		</select>
	</div>
	<button class="btn btn-default" type="button" click.delegate="search()">Search</button>
</form>

<table class="table table-striped">
	<thead>
		<tr>
			<th></th>
			<th>Date</th>
			<th>Time</th>
			<th>Status</th>
			<th>Location</th>
			<th>Referral Source</th>
			<th>Psychologist</th>
			<th>Psychometrist</th>
		</tr>
	</thead>
	<tbody>
		<tr repeat.for="appointment of appointments">
			<td>
				<button type="button" class="btn btn-default" click.delegate="edit(appointment.appointmentId)">Edit</button>
			</td>
			<td>
				${dateString(appointment.appointmentTime)}
			</td>
			<td>
				${timeString(appointment.appointmentTime)}
			</td>
			<td>
				${appointment.appointmentStatus.name}
			</td>
			<td with.bind="appointment.location">
				<span class="street">${street}</span>
				<span class="suite" if.bind="hasSuite(appointment.location)">${suite}</span>
				<span class="city">${city}</span>, <span class="province">${province}</span> <span class="postal-code">${postalCode}</span>
			</td>
			<td with.bind="appointment.assessment.referralSource">
				${name}
			</td>
			<td with.bind="appointment.psychologist">
				${firstName} ${lastName}
			</td>
			<td with.bind="appointment.psychometrist">
				${firstName} ${lastName}
			</td>
		</tr>
		<tr if.bind="!hasAppointments(appointments)">
			<td colspan="7">
				No appointments were found.
			</td>
		<tr>
	</tbody>
</table>

</template>