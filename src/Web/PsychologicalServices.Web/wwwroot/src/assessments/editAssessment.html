<template>
	<require from="valueConverters/boolean"></require>
	<require from="valueConverters/date-format"></require>
	<require from="valueConverters/gender"></require>
	<require from="valueConverters/filter"></require>
	<require from="common/validation-summary.html"></require>
	<require from="common/datepicker"></require>
	
<h2>Edit Assessment</h2>

<div class="container-fluid">
	
	<div class="row">
		<div class="col-xs-3">
			<div class="form-group">
				<label for="assessmentType">Assessment Type</label>
				<select id="assessmentType" class="form-control" value.bind="assessment.assessmentType" matcher.bind="assessmentTypeMatcher">
					<option></option>
					<option repeat.for="assessmentType of assessmentTypes" model.bind="assessmentType">
						${assessmentType.name}
					</option>
				</select>
			</div>
		</div>
		<div class="col-xs-3">
			<div class="form-group">
				<label for="reportStatus">Report Status</label>
				<select id="reportStatus" class="form-control" value.bind="assessment.reportStatus" matcher.bind="reportStatusMatcher">
					<option></option>
					<option repeat.for="reportStatus of reportStatuses" model.bind="reportStatus">
						${reportStatus.name}
					</option>
				</select>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-3">
			<div class="form-group">
				<label for="referralSource">Referral Source</label>
				<select id="referralSource" class="form-control" value.bind="assessment.referralSource" matcher.bind="referralSourceMatcher">
					<option></option>
					<option repeat.for="referralSource of referralSources" model.bind="referralSource">
						${referralSource.name}
					</option>
				</select>
			</div>
		</div>
		<div class="col-xs-3">
			<div class="form-group">
				<label for="fileSize">File Size</label>
				<input id="fileSize" type="number" class="form-control" value.bind="assessment.fileSize" />
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-3">
			<div class="form-group">
				<label for="medicalFileReceivedDate">Medical File Received Date</label>
				<input id="medicalFileReceivedDate" type="text" class="form-control" datepicker.bind="config.dpOptions" value.bind="assessment.medicalFileReceivedDate | dateFormat:config.shortDateFormat"/>
			</div>
		</div>
		<div class="col-xs-3">
			<div class="form-group">
				<label for="referralType">Referral Type</label>
				<select id="referralType" class="form-control" value.bind="assessment.referralType" matcher.bind="referralTypeMatcher" change.delegate="referralTypeChanged()">
					<option></option>
					<option repeat.for="referralType of referralTypes" model.bind="referralType">
						${referralType.name}
					</option>
				</select>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-3">
			<div class="form-group">
				<label for="referralSourceContactEmail">Referral Source Contact Email</label>
				<input id="referralSourceContactEmail" type="email" class="form-control" value.bind="assessment.referralSourceContactEmail" />
			</div>
		</div>
		<div class="col-xs-3">
			<label>Issues in Dispute</label>
			<div class="checkbox" repeat.for="issueInDispute of issuesInDispute">
				<label>
					<input type="checkbox" model.bind="issueInDispute" checked.bind="assessment.issuesInDispute" matcher.bind="issueInDisputeMatcher" change.delegate="checkMedRehab()" />&nbsp;${issueInDispute.name}
				</label>
			</div>
		</div>
	</div>
	
	<div class="row" if.bind="medRehabSelected">
		<div class="col-xs-6">
			<table class="table table-striped">
				<caption>Med Rehabs</caption>
				<thead>
					<tr>
						<th>
							<button type="button" class="btn btn-default" click.delegate="newMedRehab()">
								<i class="fa fa-plus"></i>
							</button>
						</th>
						<th>Date</th>
						<th>Amount</th>
						<th>Description</th>
						<th>Deleted</th>
					</tr>
				</thead>
				<tbody>
					<tr repeat.for="medRehab of assessment.medRehabs">
						<td>
							<button type="button" class="btn btn-default" click.delegate="editMedRehab(medRehab)">
								<i class="fa fa-edit"></i>
							</button>
						</td>
						<td>${medRehab.date | dateFormat:config.shortDateFormat}</td>
						<td>${medRehab.amount}</td>
						<td>${medRehab.description}</td>
						<td>
							<input type="checkbox" checked.bind="medRehab.deleted" />
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-3">
			<div class="form-group">
				<label for="docListWriter">Doc List Writer</label>
				<select id="docListWriter" class="form-control" value.bind="assessment.docListWriter" matcher.bind="userMatcher">
					<option></option>
					<option repeat.for="user of docListWriters" model.bind="user">
						${user.firstName}
					</option>
				</select>
			</div>
		</div>
		<div class="col-xs-3">
			<div class="form-group">
				<label for="notesWriter">Notes Writer</label>
				<select id="notesWriter" class="form-control" value.bind="assessment.notesWriter" matcher.bind="userMatcher">
					<option></option>
					<option repeat.for="user of notesWriters" model.bind="user">
						${user.firstName}
					</option>
				</select>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-3">
			<div class="form-group">
				<label for="company">Company</label>
				<select id="company" class="form-control" value.bind="assessment.company" matcher.bind="companyMatcher">
					<option></option>
					<option repeat.for="company of companies" model.bind="company">
						${company.name}
					</option>
				</select>
			</div>
		</div>
		<div class="col-xs-2">
			<div class="form-group">
				<label>Claimant</label>
				<p class="form-control-static" if.bind="claimant">
					${claimant.firstName} ${claimant.lastName}
					<br>${claimant.age} - ${claimant.gender | gender}
				</p>
				<button type="button" class="btn btn-default" click.delegate="searchClaimant()">
					Search <i class="fa fa-search"></i>
				</button>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-6">
			
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-6">
			<table class="table table-striped">
				<caption>Claims</caption>
				<thead>
					<tr>
						<th>
							<button type="button" class="btn btn-default" click.delegate="newClaim()" disabled.bind="!claimant">
								<i class="fa fa-plus"></i>
							</button>
						</th>
						<th>Claim #</th>
						<th>Date of Loss</th>
						<th>Deleted</th>
					</tr>
				</thead>
				<tbody>
					<tr repeat.for="claim of assessment.claims">
						<td>
							<button type="button" class="btn btn-default" click.delegate="editClaim(claim)">
								<i class="fa fa-edit"></i>
							</button>
						</td>
						<td>${claim.claimNumber}</td>
						<td>${claim.dateOfLoss | dateFormat:config.shortDateFormat}</td>
						<td>
							<input type="checkbox" checked.bind="claim.deleted" />
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-6">
			<table class="table table-striped">
				<caption>Appointments</caption>
				<thead>
					<tr>
						<th>
							<button type="button" class="btn btn-default" click.delegate="newAppointment()">
								<i class="fa fa-plus"></i>
							</button>
						</th>
						<th>Date/Time</th>
						<th>Location</th>
						<th>Status</th>
						<th>Psychometrist</th>
						<th>Confirmed</th>
						<th>Deleted</th>
					</tr>
				</thead>
				<tbody>
					<tr repeat.for="appointment of assessment.appointments">
						<td>
							<button type="button" class="btn btn-default" click.delegate="editAppointment(appointment)">
								<i class="fa fa-edit"></i>
							</button>
						</td>
						<td>
							${appointment.appointmentTime | dateFormat:config.shortDateFormat}
							<br>${appointment.appointmentTime | dateFormat:config.shortTimeFormat}
						</td>
						<td>${appointment.location.name}</td>
						<td>${appointment.appointmentStatus.name}</td>
						<td>${appointment.psychometrist.firstName}</td>
						<td>${appointment.psychometristConfirmed | boolean}</td>
						<td>
							<input type="checkbox" checked.bind="appointment.deleted" />
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	
	<div class="row" if.bind="validationErrors">
		<div class="col-xs-6">
			<validation-summary errors.bind="validationErrors"></validation-summary>
		</div>
	</div>
	
	<div class="row">
		<div class="col-xs-6">
			<button type="button" class="btn btn-default" click.delegate="back()">
				<i class="fa fa-arrow-left"></i> Back
			</button>
			<button type="button" class="btn btn-primary" click.delegate="save()">
				Save <i class="fa fa-save"></i>
			</button>
		</div>
	</div>

</div>

</template>