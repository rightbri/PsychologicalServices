<template>
	<require from="resources/value-converters/date-format"></require>
	<require from="resources/value-converters/money"></require>
	<require from="common/date-picker"></require>
	<require from="common/fixed-header"></require>
	<require from="../../content/css/fixed-header.css"></require>

<div class="uk-container">

	<fieldset class="uk-fieldset">
		<legend class="uk-legend">Invoices</legend>
		
		<form class="uk-form-stacked">
		
			<div class="uk-margin">
				<label class="uk-form-label" for="searchIdentifier">Invoice ID</label>
				<div class="uk-form-controls">
					<input id="searchIdentifier" type="text" class="uk-input" value.bind="searchIdentifier" />
				</div>
			</div>
		
			<div class="uk-margin">
				<label class="uk-form-label" for="searchDate">Invoice Date</label>
				<div class="uk-form-controls">
					<input id="searchDate" type="text" class="uk-input" value.bind="searchDate" date-picker.bind="config.datepickerOptions" />
				</div>
			</div>
			
			<div class="uk-margin">
				<label class="uk-form-label" for="searchStatus">Status</label>
				<div class="uk-form-controls">
					<select id="searchStatus" class="uk-select" value.bind="searchStatus" matcher.bind="invoiceStatusMatcher">
						<option></option>
						<option repeat.for="invoiceStatus of invoiceStatuses" model.bind="invoiceStatus">
							${invoiceStatus.name}
						</option>
					</select>
				</div>
			</div>
			
			<div class="uk-margin">
				<label class="uk-form-label" for="searchType">Invoice Type</label>
				<div class="uk-form-controls">
					<select id="searchType" class="uk-select" value.bind="searchType" matcher.bind="invoiceTypeMatcher">
						<option></option>
						<option repeat.for="invoiceType of invoiceTypes" model.bind="invoiceType">
							${invoiceType.name}
						</option>
					</select>
				</div>
			</div>
			
			<div class="uk-margin">
				<label class="uk-form-label" for="searchPayableTo">Payable To</label>
				<div class="uk-form-controls">
					<select id="searchPayableTo" class="uk-select" value.bind="searchPayableTo" matcher.bind="payableToMatcher">
						<option></option>
						<option repeat.for="payableTo of payableTos" model.bind="payableTo">
							${payableTo.firstName} ${payableTo.lastName}
						</option>
					</select>
				</div>
			</div>
			
			<div class="uk-margin">
				<button type="button" class="uk-button uk-button-primary" click.delegate="searchInvoices()">
					Search
				</button>
			</div>
		</form>
		
	</fieldset>

</div>

<div class="uk-overflow-auto" if.bind="invoices">
	<table class="uk-table uk-table-divider" fixed-header>
		<thead>
			<tr>
				<th></th>
				<th>ID</th>
				<th>Date</th>
				<th>Status</th>
				<th>Type</th>
				<th>Payable To</th>
				<th>Amount</th>
				<th>Referral Source</th>
				<th>Claimant</th>
			</tr>
		</thead>
		<tbody>
			<tr repeat.for="invoice of invoices">
				<td>
					<a route-href="route: editInvoice; params.bind: { id: invoice.invoiceId }" class="uk-button uk-button-default">
						Edit
					</a>
				</td>
				<td>${invoice.identifier}</td>
				<td>${invoice.invoiceDate | dateFormat:config.longDateFormat}</td>
				<td>${invoice.invoiceStatus.name}</td>
				<td>${invoice.invoiceType.name}</td>
				<td>${invoice.payableTo.firstName} ${invoice.payableTo.lastName}</td>
				<td>${invoice.total | money}</td>
				<td>${invoice.referralSource.name}</td>
				<td>
					<ul class="uk-list">
						<li>
							${invoice.claimant.firstName} ${invoice.claimant.lastName}
						</li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>
</div>
</template>